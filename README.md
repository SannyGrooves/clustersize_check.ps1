# clustersize_check.ps1
Check full system drive info and perform system drive health check.
<img width="1008" height="636" alt="image" src="https://github.com/user-attachments/assets/03844b97-4064-44e6-a6be-f3e88eb6f607" />
How to Run

Save as clustersize_check.ps1
Run in PowerShell as Administrator (for best SMART data):powershellSet-ExecutionPolicy RemoteSigned -Scope CurrentUser -Force
.\clustersize_check.ps1
Open drive_info.html in any browser.

<img width="923" height="439" alt="image" src="https://github.com/user-attachments/assets/ca44ce0c-8dc4-40bd-9e3d-14dfabd3fa76" />

New Features Added:
Drive Lette
SystemYesCluster Size (KB)
Total / Free Space
Partition Style (GPT/MBR)
Disk Model / SerialYesHealth Status
(Color-coded)SMART Temp / Wear
(if available)Responsive HTMLYesAdmin not requiredWarning (SMART limited)
Read/Write IOPS
Read/Write Latency (ms)
Disk Queue Length
Throughput (MB/s)
Temperature & Wear (SSD)
Performance Health Indicator
Live 5-second sampling for accurate metrics

The script:
<code><span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># clustersize_check.ps1</span></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># Full Drive Report: Size, Health, Cluster, Performance</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$ErrorActionPreference</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'SilentlyContinue'</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># === Performance Sampling (5 seconds) ===</span></span>
<span class="line"><span style="color: rgb(26, 179, 148);">Write-Host</span><span style="color: rgb(164, 65, 133);"> "Collecting performance metrics (5 seconds)..."</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">ForegroundColor Cyan</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$perfCounters</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(26, 179, 148);"> Get-Counter</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">Counter </span><span style="color: rgb(123, 48, 208);">@</span><span style="color: rgb(0, 35, 57);">(</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Avg. Disk sec/Read"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Avg. Disk sec/Write"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Avg. Disk Queue Length"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Disk Reads/sec"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Disk Writes/sec"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Disk Read Bytes/sec"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Disk Write Bytes/sec"</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">) </span><span style="color: rgb(123, 48, 208);">-</span><span style="color: rgb(0, 35, 57);">SampleInterval </span><span style="color: rgb(23, 71, 129);">1</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">MaxSamples </span><span style="color: rgb(23, 71, 129);">5</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">ErrorAction SilentlyContinue</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># Parse performance data</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> @</span><span style="color: rgb(0, 35, 57);">{}</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfCounters</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $perfCounters.CounterSamples</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> ForEach-Object</span><span style="color: rgb(0, 35, 57);"> {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $instance</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> $_</span><span style="color: rgb(47, 134, 210);">.InstanceName</span><span style="color: rgb(123, 48, 208);"> -replace</span><span style="color: rgb(164, 65, 133);"> '^\d+[_ ]'</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(164, 65, 133);"> ''</span><span style="color: rgb(53, 123, 66); font-style: italic;">  # Clean instance name</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $path</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> $_</span><span style="color: rgb(47, 134, 210);">.Path</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $value</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> $_</span><span style="color: rgb(47, 134, 210);">.CookedValue</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Avg. Disk sec/Read"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.ReadLatency"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);"> *</span><span style="color: rgb(23, 71, 129);"> 1000</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Avg. Disk sec/Write"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.WriteLatency"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);"> *</span><span style="color: rgb(23, 71, 129);"> 1000</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Avg. Disk Queue Length"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.QueueLength"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Disk Reads/sec"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.ReadIOPS"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 0</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Disk Writes/sec"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.WriteIOPS"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 0</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Disk Read Bytes/sec"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.ReadMBps"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(123, 48, 208);">MB,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Disk Write Bytes/sec"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.WriteMBps"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(123, 48, 208);">MB,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># === Get Volumes ===</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$volumes</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(26, 179, 148);"> Get-Volume</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> Where-Object</span><span style="color: rgb(0, 35, 57);"> { $_</span><span style="color: rgb(47, 134, 210);">.DriveLetter</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$data</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> @</span><span style="color: rgb(0, 35, 57);">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(123, 48, 208);">foreach</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$vol</span><span style="color: rgb(123, 48, 208);"> in</span><span style="color: rgb(47, 134, 210);"> $volumes</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $driveLetter</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $vol.DriveLetter</span><span style="color: rgb(123, 48, 208);"> +</span><span style="color: rgb(164, 65, 133);"> ':'</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $fileSystem</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $vol.FileSystem</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $totalSizeGB</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$vol.Size</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(123, 48, 208);">GB,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">)</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $freeSizeGB</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$vol.SizeRemaining</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(123, 48, 208);">GB,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">)</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $freePct</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$totalSizeGB</span><span style="color: rgb(123, 48, 208);"> -gt</span><span style="color: rgb(23, 71, 129);"> 0</span><span style="color: rgb(0, 35, 57);">) { [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round((</span><span style="color: rgb(47, 134, 210);">$freeSizeGB</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(47, 134, 210);"> $totalSizeGB</span><span style="color: rgb(0, 35, 57);">) </span><span style="color: rgb(123, 48, 208);">*</span><span style="color: rgb(23, 71, 129);"> 100</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(0, 35, 57);">) } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(23, 71, 129);">0</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $clusterSizeKB</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$vol.AllocationUnitSize</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$vol.AllocationUnitSize</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1024</span><span style="color: rgb(0, 35, 57);"> } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;">    # Volume health</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $volumeHealth</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $vol.HealthStatus</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $operationalStatus</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $vol.OperationalStatus</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;">    # Partition &amp; Disk</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $partition</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(26, 179, 148);"> Get-Partition</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">DriveLetter </span><span style="color: rgb(47, 134, 210);">$vol.DriveLetter</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">ErrorAction SilentlyContinue</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">    if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$partition</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $disk</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(26, 179, 148);"> Get-Disk</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">Number </span><span style="color: rgb(47, 134, 210);">$partition.DiskNumber</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskNumber</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.Number</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskModel</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.Model</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskSerial</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.SerialNumber.Trim</span><span style="color: rgb(0, 35, 57);">()</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskSizeGB</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$disk.Size</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(123, 48, 208);">GB,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">)</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskFirmware</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.FirmwareVersion</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskHealth</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.HealthStatus</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $isSSD</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.IsSSD</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskType</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$isSSD</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">"SSD"</span><span style="color: rgb(0, 35, 57);"> } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">"HDD"</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $partitionStyle</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.PartitionStyle</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;">        # Match performance by disk model/serial or number</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $perfKey</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(47, 134, 210);">$diskNumber</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(53, 123, 66); font-style: italic;">  # fallback</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskKey</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(47, 134, 210);">$diskModel</span><span style="color: rgb(47, 134, 210);"> $diskSerial</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(0, 35, 57);">.Trim()</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $perfInstance</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $perfData.Keys</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> Where-Object</span><span style="color: rgb(0, 35, 57);"> { $_ </span><span style="color: rgb(123, 48, 208);">-like</span><span style="color: rgb(164, 65, 133);"> "*</span><span style="color: rgb(47, 134, 210);">$diskNumber</span><span style="color: rgb(164, 65, 133);">*"</span><span style="color: rgb(123, 48, 208);"> -or</span><span style="color: rgb(0, 35, 57);"> $_ </span><span style="color: rgb(123, 48, 208);">-like</span><span style="color: rgb(164, 65, 133);"> "*</span><span style="color: rgb(47, 134, 210);">$diskKey</span><span style="color: rgb(164, 65, 133);">*"</span><span style="color: rgb(0, 35, 57);"> } </span><span style="color: rgb(123, 48, 208);">|</span><span style="color: rgb(26, 179, 148);"> Select-Object</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">First </span><span style="color: rgb(23, 71, 129);">1</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $readLatency</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.ReadLatency"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $writeLatency</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.WriteLatency"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $queueLength</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.QueueLength"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $readIOPS</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.ReadIOPS"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $writeIOPS</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.WriteIOPS"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $readMBps</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.ReadMBps"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $writeMBps</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.WriteMBps"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;">        # SMART via StorageReliabilityCounter</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $smartTemp</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span><span style="color: rgb(0, 35, 57);">; </span><span style="color: rgb(47, 134, 210);">$smartWear</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        try</span><span style="color: rgb(0, 35, 57);"> {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">            $rel</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(26, 179, 148);"> Get-StorageReliabilityCounter</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">PhysicalDisk (</span><span style="color: rgb(26, 179, 148);">Get-PhysicalDisk</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> Where-Object</span><span style="color: rgb(0, 35, 57);"> DeviceId </span><span style="color: rgb(123, 48, 208);">-eq</span><span style="color: rgb(47, 134, 210);"> $diskNumber</span><span style="color: rgb(0, 35, 57);">) </span><span style="color: rgb(123, 48, 208);">-</span><span style="color: rgb(0, 35, 57);">ErrorAction SilentlyContinue</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">            if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$rel</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">                $smartTemp</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(47, 134, 210);">$rel.Temperature</span><span style="color: rgb(164, 65, 133);">)</span><span style="color: rgb(164, 65, 133);">Â°C"</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">                if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$rel.Wear</span><span style="color: rgb(123, 48, 208);"> -ne</span><span style="color: rgb(23, 71, 129);"> $null</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$smartWear</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(47, 134, 210);">$rel.Wear</span><span style="color: rgb(164, 65, 133);">)</span><span style="color: rgb(164, 65, 133);">%"</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">            }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        } </span><span style="color: rgb(123, 48, 208);">catch</span><span style="color: rgb(0, 35, 57);"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> {</span></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;">        # Fallback for no partition</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskNumber</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskModel</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskSerial</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskSizeGB</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskFirmware</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskHealth</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskType</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $partitionStyle</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $readLatency</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $writeLatency</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $queueLength</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $readIOPS</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $writeIOPS</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $readMBps</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $writeMBps</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $smartTemp</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $smartWear</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;">    # === Health Summary ===</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $healthSummary</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> switch</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(23, 71, 129);">$true</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        (</span><span style="color: rgb(47, 134, 210);">$diskHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Healthy'</span><span style="color: rgb(123, 48, 208);"> -and</span><span style="color: rgb(47, 134, 210);"> $volumeHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Healthy'</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="badge healthy"&gt;Healthy&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        (</span><span style="color: rgb(47, 134, 210);">$diskHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Warning'</span><span style="color: rgb(123, 48, 208);"> -or</span><span style="color: rgb(47, 134, 210);"> $volumeHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Warning'</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="badge warning"&gt;Warning&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        (</span><span style="color: rgb(47, 134, 210);">$diskHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Unhealthy'</span><span style="color: rgb(123, 48, 208);"> -or</span><span style="color: rgb(47, 134, 210);"> $volumeHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Unhealthy'</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="badge failed"&gt;Failed&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        (</span><span style="color: rgb(47, 134, 210);">$operationalStatus</span><span style="color: rgb(123, 48, 208);"> -ne</span><span style="color: rgb(164, 65, 133);"> 'OK'</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="badge failed"&gt;Offline&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        default</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="badge unknown"&gt;Unknown&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;">    # === Performance Grade ===</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $perfGrade</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">    if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$readLatency</span><span style="color: rgb(123, 48, 208);"> -ne</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span><span style="color: rgb(123, 48, 208);"> -and</span><span style="color: rgb(47, 134, 210);"> $writeLatency</span><span style="color: rgb(123, 48, 208);"> -ne</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $avgLat</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$readLatency</span><span style="color: rgb(123, 48, 208);"> +</span><span style="color: rgb(47, 134, 210);"> $writeLatency</span><span style="color: rgb(0, 35, 57);">) </span><span style="color: rgb(123, 48, 208);">/</span><span style="color: rgb(23, 71, 129);"> 2</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $perfGrade</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> switch</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(23, 71, 129);">$true</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">            (</span><span style="color: rgb(47, 134, 210);">$avgLat</span><span style="color: rgb(123, 48, 208);"> -lt</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="perf excellent"&gt;Excellent&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">            (</span><span style="color: rgb(47, 134, 210);">$avgLat</span><span style="color: rgb(123, 48, 208);"> -lt</span><span style="color: rgb(23, 71, 129);"> 5</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="perf good"&gt;Good&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">            (</span><span style="color: rgb(47, 134, 210);">$avgLat</span><span style="color: rgb(123, 48, 208);"> -lt</span><span style="color: rgb(23, 71, 129);"> 15</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="perf fair"&gt;Fair&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">            default</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="perf poor"&gt;Poor&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;">    # === Build Object ===</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $obj</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">PSCustomObject</span><span style="color: rgb(0, 35, 57);">]</span><span style="color: rgb(123, 48, 208);">@</span><span style="color: rgb(0, 35, 57);">{</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Drive'</span><span style="color: rgb(123, 48, 208);">           =</span><span style="color: rgb(47, 134, 210);"> $driveLetter</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'FS'</span><span style="color: rgb(123, 48, 208);">              =</span><span style="color: rgb(47, 134, 210);"> $fileSystem</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Cluster (KB)'</span><span style="color: rgb(123, 48, 208);">    =</span><span style="color: rgb(47, 134, 210);"> $clusterSizeKB</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Total (GB)'</span><span style="color: rgb(123, 48, 208);">      =</span><span style="color: rgb(47, 134, 210);"> $totalSizeGB</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Free (GB)'</span><span style="color: rgb(123, 48, 208);">       =</span><span style="color: rgb(47, 134, 210);"> $freeSizeGB</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Free %'</span><span style="color: rgb(123, 48, 208);">          =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(47, 134, 210);">$freePct</span><span style="color: rgb(164, 65, 133);">%"</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Part. Style'</span><span style="color: rgb(123, 48, 208);">     =</span><span style="color: rgb(47, 134, 210);"> $partitionStyle</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Disk #'</span><span style="color: rgb(123, 48, 208);">          =</span><span style="color: rgb(47, 134, 210);"> $diskNumber</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Model'</span><span style="color: rgb(123, 48, 208);">           =</span><span style="color: rgb(47, 134, 210);"> $diskModel</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Serial'</span><span style="color: rgb(123, 48, 208);">          =</span><span style="color: rgb(47, 134, 210);"> $diskSerial</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Type'</span><span style="color: rgb(123, 48, 208);">            =</span><span style="color: rgb(47, 134, 210);"> $diskType</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Health'</span><span style="color: rgb(123, 48, 208);">          =</span><span style="color: rgb(47, 134, 210);"> $healthSummary</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Temp'</span><span style="color: rgb(123, 48, 208);">            =</span><span style="color: rgb(47, 134, 210);"> $smartTemp</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Wear'</span><span style="color: rgb(123, 48, 208);">            =</span><span style="color: rgb(47, 134, 210);"> $smartWear</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Read IOPS'</span><span style="color: rgb(123, 48, 208);">       =</span><span style="color: rgb(47, 134, 210);"> $readIOPS</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Write IOPS'</span><span style="color: rgb(123, 48, 208);">      =</span><span style="color: rgb(47, 134, 210);"> $writeIOPS</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Read MB/s'</span><span style="color: rgb(123, 48, 208);">       =</span><span style="color: rgb(47, 134, 210);"> $readMBps</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Write MB/s'</span><span style="color: rgb(123, 48, 208);">      =</span><span style="color: rgb(47, 134, 210);"> $writeMBps</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'R-Latency (ms)'</span><span style="color: rgb(123, 48, 208);">  =</span><span style="color: rgb(47, 134, 210);"> $readLatency</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'W-Latency (ms)'</span><span style="color: rgb(123, 48, 208);">  =</span><span style="color: rgb(47, 134, 210);"> $writeLatency</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Queue'</span><span style="color: rgb(123, 48, 208);">           =</span><span style="color: rgb(47, 134, 210);"> $queueLength</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Perf Grade'</span><span style="color: rgb(123, 48, 208);">      =</span><span style="color: rgb(47, 134, 210);"> $perfGrade</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $data</span><span style="color: rgb(123, 48, 208);"> +=</span><span style="color: rgb(47, 134, 210);"> $obj</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># === HTML Output ===</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$header</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> @"</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;!DOCTYPE html&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;html lang="en"&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;head&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;meta charset="UTF-8"&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;title&gt;Drive Performance &amp; Health Report&lt;/title&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;style&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        body {</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">            background: linear-gradient(135deg, #e3f2fd, #bbdefb);</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">            margin: 0; padding: 20px; color: #333;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .container {</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">            max-width: 1600px; margin: auto; background: white; padding: 30px;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">            border-radius: 15px; box-shadow: 0 15px 35px rgba(0,0,0,0.1);</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        h1 { text-align: center; color: #1565c0; margin-bottom: 5px; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .subtitle { text-align: center; color: #555; font-style: italic; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        table {</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">            width: 100%; border-collapse: collapse; margin: 25px 0;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">            font-size: 14px; box-shadow: 0 4px 15px rgba(0,0,0,0.05);</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        th { background: #1565c0; color: white; padding: 14px; text-align: left; font-weight: 600; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        td { padding: 10px 12px; border-bottom: 1px solid #eee; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        tr:nth-child(even) { background-color: #f9fbfd; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        tr:hover { background-color: #e1f5fe; transition: 0.2s; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .badge { padding: 5px 10px; border-radius: 20px; font-size: 0.8em; font-weight: bold; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .healthy { background:#e8f5e9; color:#2e7d32; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .warning { background:#fff3e0; color:#ef6c00; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .failed { background:#ffebee; color:#c62828; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .unknown { background:#eee; color:#555; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .perf { padding: 4px 8px; border-radius: 12px; font-size: 0.75em; font-weight: bold; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .excellent { background:#e8f5e9; color:#1b5e20; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .good { background:#e6f7ff; color:#00695c; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .fair { background:#fff8e1; color:#ff8f00; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .poor { background:#ffebee; color:#b71c1c; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .footer {</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">            text-align: center; margin-top: 50px; color: #777; font-size: 0.9em;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .note {</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">            background: #e3f2fd; padding: 12px; border-radius: 8px; margin: 15px 0;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">            font-size: 0.9em; color: #1565c0;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;/style&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;/head&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;body&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;div class="container"&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;h1&gt;Drive Performance &amp; Health Report&lt;/h1&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;p class="subtitle"&gt;Generated on </span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(26, 179, 148);">Get-Date</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(164, 65, 133);">Format </span><span style="color: rgb(164, 65, 133);">'dddd, MMMM dd, yyyy @ HH:mm:ss'</span><span style="color: rgb(164, 65, 133);">)</span><span style="color: rgb(164, 65, 133);">&lt;/p&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;p&gt;&lt;strong&gt;Host:&lt;/strong&gt; </span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(47, 134, 210);">$env:COMPUTERNAME</span><span style="color: rgb(164, 65, 133);">)</span><span style="color: rgb(164, 65, 133);"> | &lt;strong&gt;User:&lt;/strong&gt; </span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(47, 134, 210);">$env:USERNAME</span><span style="color: rgb(164, 65, 133);">)</span><span style="color: rgb(164, 65, 133);">&lt;/p&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;div class="note"&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        &lt;strong&gt;Note:&lt;/strong&gt; Performance metrics are averaged over 5 seconds. For accurate results, ensure disk activity during scan.</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;/div&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">"@</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># Convert to HTML</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$htmlTable</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $data</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> Sort-Object</span><span style="color: rgb(0, 35, 57);"> Drive </span><span style="color: rgb(123, 48, 208);">|</span><span style="color: rgb(26, 179, 148);"> ConvertTo-Html</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">Fragment </span><span style="color: rgb(123, 48, 208);">-</span><span style="color: rgb(0, 35, 57);">Property </span><span style="color: rgb(123, 48, 208);">*</span><span style="color: rgb(123, 48, 208);"> -As</span><span style="color: rgb(0, 35, 57);"> Table</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># Replace badges</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$replacements</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> @</span><span style="color: rgb(0, 35, 57);">{</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Healthy'</span><span style="color: rgb(123, 48, 208);">   =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="badge healthy"&gt;Healthy&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Warning'</span><span style="color: rgb(123, 48, 208);">   =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="badge warning"&gt;Warning&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Failed'</span><span style="color: rgb(123, 48, 208);">    =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="badge failed"&gt;Failed&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Offline'</span><span style="color: rgb(123, 48, 208);">   =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="badge failed"&gt;Offline&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Unknown'</span><span style="color: rgb(123, 48, 208);">   =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="badge unknown"&gt;Unknown&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Excellent'</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="perf excellent"&gt;Excellent&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Good'</span><span style="color: rgb(123, 48, 208);">      =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="perf good"&gt;Good&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Fair'</span><span style="color: rgb(123, 48, 208);">      =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="perf fair"&gt;Fair&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Poor'</span><span style="color: rgb(123, 48, 208);">      =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="perf poor"&gt;Poor&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(123, 48, 208);">foreach</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$key</span><span style="color: rgb(123, 48, 208);"> in</span><span style="color: rgb(47, 134, 210);"> $replacements.Keys</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $htmlTable</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $htmlTable</span><span style="color: rgb(123, 48, 208);"> -replace</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">regex</span><span style="color: rgb(0, 35, 57);">]::Escape(</span><span style="color: rgb(164, 65, 133);">"&lt;td&gt;</span><span style="color: rgb(47, 134, 210);">$key</span><span style="color: rgb(164, 65, 133);">&lt;/td&gt;"</span><span style="color: rgb(0, 35, 57);">)</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(164, 65, 133);"> "&lt;td&gt;</span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(47, 134, 210);">$replacements</span><span style="color: rgb(164, 65, 133);">[</span><span style="color: rgb(47, 134, 210);">$key</span><span style="color: rgb(164, 65, 133);">])</span><span style="color: rgb(164, 65, 133);">&lt;/td&gt;"</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$footer</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> @"</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;div class="footer"&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        Generated by &lt;strong&gt;clustersize_check.ps1&lt;/strong&gt; | </span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        Performance: 5-second sample | Requires Admin for full data</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;/div&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;/div&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;/body&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;/html&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">"@</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$html</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $header</span><span style="color: rgb(123, 48, 208);"> +</span><span style="color: rgb(47, 134, 210);"> $htmlTable</span><span style="color: rgb(123, 48, 208);"> +</span><span style="color: rgb(47, 134, 210);"> $footer</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$html</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> Out-File</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">FilePath </span><span style="color: rgb(164, 65, 133);">".\drive_info.html"</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">Encoding UTF8</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(26, 179, 148);">Write-Host</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(23, 71, 129);">`n</span><span style="color: rgb(164, 65, 133);">Drive report with performance metrics exported to: "</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">NoNewline</span></span>
<span class="line"><span style="color: rgb(26, 179, 148);">Write-Host</span><span style="color: rgb(164, 65, 133);"> "drive_info.html"</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">ForegroundColor Green</span></span>
<span class="line"><span style="color: rgb(26, 179, 148);">Write-Host</span><span style="color: rgb(164, 65, 133);"> "Open in browser to view full interactive report.</span><span style="color: rgb(23, 71, 129);">`n</span><span style="color: rgb(164, 65, 133);">"</span></span></code>
