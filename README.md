# clustersize_check.ps1
Check full system drive info and perform system drive health check.
<img width="1008" height="636" alt="image" src="https://github.com/user-attachments/assets/03844b97-4064-44e6-a6be-f3e88eb6f607" />
How to Run
 
Save as clustersize_check.ps1
Run in PowerShell as Administrator (for best SMART data):powershellSet-ExecutionPolicy RemoteSigned -Scope CurrentUser -Force
.\clustersize_check.ps1
Open drive_info.html in any browser.
TIP!
Run as Admin → Full SMART + Performance
Double-click script → Works if .ps1 is associated
Schedule it → Add to Task Scheduler

<img width="923" height="439" alt="image" src="https://github.com/user-attachments/assets/ca44ce0c-8dc4-40bd-9e3d-14dfabd3fa76" />

New Features Added:
Drive Lette
SystemYesCluster Size (KB)
Total / Free Space
Partition Style (GPT/MBR)
Disk Model / SerialYesHealth Status
(Color-coded)SMART Temp / Wear
(if available)Responsive HTMLYesAdmin not requiredWarning (SMART limited)
Read/Write IOPS
Read/Write Latency (ms)
Disk Queue Length
Throughput (MB/s)
Temperature & Wear (SSD)
Performance Health Indicator
Live 5-second sampling for accurate metrics

The script:
<div class="shiki not-prose relative [&amp;_pre]:overflow-auto [&amp;_pre]:rounded-b-lg [&amp;_pre]:px-4 [&amp;_pre]:py-4 !p-0" style="border-radius: 0px 0px 12px 12px; border-top: none; border-right-color: ; border-right-style: ; border-right-width: ; border-bottom-color: ; border-bottom-style: ; border-bottom-width: ; border-left-color: ; border-left-style: ; border-left-width: ; border-image-source: ; border-image-slice: ; border-image-width: ; border-image-outset: ; border-image-repeat: ; padding: 16px; margin-top: 0px; font-size: 0.9em; font-family: var(--font-ibm-plex-mono); line-height: 1.5em; background-color: white; color: var(--fg-primary); display: block; overflow: auto;"><pre class="shiki slack-ochin" tabindex="0" style="background-color: rgb(255, 255, 255); color: rgb(0, 35, 57);"><code><span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># clustersize_check.ps1</span></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># Full Responsive Drive Report + Auto-Open HTML</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$ErrorActionPreference</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'SilentlyContinue'</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># === Performance Sampling (5 seconds) ===</span></span>
<span class="line"><span style="color: rgb(26, 179, 148);">Write-Host</span><span style="color: rgb(164, 65, 133);"> "Collecting performance metrics (5 seconds)..."</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">ForegroundColor Cyan</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$perfCounters</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(26, 179, 148);"> Get-Counter</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">Counter </span><span style="color: rgb(123, 48, 208);">@</span><span style="color: rgb(0, 35, 57);">(</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Avg. Disk sec/Read"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Avg. Disk sec/Write"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Avg. Disk Queue Length"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Disk Reads/sec"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Disk Writes/sec"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Disk Read Bytes/sec"</span><span style="color: rgb(123, 48, 208);">,</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    "\PhysicalDisk(*)\Disk Write Bytes/sec"</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">) </span><span style="color: rgb(123, 48, 208);">-</span><span style="color: rgb(0, 35, 57);">SampleInterval </span><span style="color: rgb(23, 71, 129);">1</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">MaxSamples </span><span style="color: rgb(23, 71, 129);">5</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">ErrorAction SilentlyContinue</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> @</span><span style="color: rgb(0, 35, 57);">{}</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfCounters</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $perfCounters.CounterSamples</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> ForEach-Object</span><span style="color: rgb(0, 35, 57);"> {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $instance</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> $_</span><span style="color: rgb(47, 134, 210);">.InstanceName</span><span style="color: rgb(123, 48, 208);"> -replace</span><span style="color: rgb(164, 65, 133);"> '^\d+[_ ]'</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(164, 65, 133);"> ''</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $path</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> $_</span><span style="color: rgb(47, 134, 210);">.Path</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $value</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> $_</span><span style="color: rgb(47, 134, 210);">.CookedValue</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Avg. Disk sec/Read"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.ReadLatency"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);"> *</span><span style="color: rgb(23, 71, 129);"> 1000</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Avg. Disk sec/Write"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.WriteLatency"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);"> *</span><span style="color: rgb(23, 71, 129);"> 1000</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Avg. Disk Queue Length"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.QueueLength"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Disk Reads/sec"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.ReadIOPS"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 0</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Disk Writes/sec"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.WriteIOPS"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 0</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Disk Read Bytes/sec"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.ReadMBps"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(123, 48, 208);">MB,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$path</span><span style="color: rgb(123, 48, 208);"> -like</span><span style="color: rgb(164, 65, 133);"> "*Disk Write Bytes/sec"</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$instance</span><span style="color: rgb(164, 65, 133);">.WriteMBps"</span><span style="color: rgb(0, 35, 57);">] </span><span style="color: rgb(123, 48, 208);">=</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$value</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(123, 48, 208);">MB,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">) }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># === Get Volumes ===</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$volumes</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(26, 179, 148);"> Get-Volume</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> Where-Object</span><span style="color: rgb(0, 35, 57);"> { $_</span><span style="color: rgb(47, 134, 210);">.DriveLetter</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$data</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> @</span><span style="color: rgb(0, 35, 57);">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(123, 48, 208);">foreach</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$vol</span><span style="color: rgb(123, 48, 208);"> in</span><span style="color: rgb(47, 134, 210);"> $volumes</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $driveLetter</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $vol.DriveLetter</span><span style="color: rgb(123, 48, 208);"> +</span><span style="color: rgb(164, 65, 133);"> ':'</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $fileSystem</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $vol.FileSystem</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $totalSizeGB</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$vol.Size</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(123, 48, 208);">GB,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">)</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $freeSizeGB</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$vol.SizeRemaining</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(123, 48, 208);">GB,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">)</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $freePct</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$totalSizeGB</span><span style="color: rgb(123, 48, 208);"> -gt</span><span style="color: rgb(23, 71, 129);"> 0</span><span style="color: rgb(0, 35, 57);">) { [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round((</span><span style="color: rgb(47, 134, 210);">$freeSizeGB</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(47, 134, 210);"> $totalSizeGB</span><span style="color: rgb(0, 35, 57);">) </span><span style="color: rgb(123, 48, 208);">*</span><span style="color: rgb(23, 71, 129);"> 100</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(0, 35, 57);">) } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(23, 71, 129);">0</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $clusterSizeKB</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$vol.AllocationUnitSize</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$vol.AllocationUnitSize</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1024</span><span style="color: rgb(0, 35, 57);"> } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $volumeHealth</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $vol.HealthStatus</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $operationalStatus</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $vol.OperationalStatus</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $partition</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(26, 179, 148);"> Get-Partition</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">DriveLetter </span><span style="color: rgb(47, 134, 210);">$vol.DriveLetter</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">ErrorAction SilentlyContinue</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">    if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$partition</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $disk</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(26, 179, 148);"> Get-Disk</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">Number </span><span style="color: rgb(47, 134, 210);">$partition.DiskNumber</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskNumber</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.Number</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskModel</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.Model</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskSerial</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.SerialNumber.Trim</span><span style="color: rgb(0, 35, 57);">()</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskSizeGB</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">math</span><span style="color: rgb(0, 35, 57);">]::Round(</span><span style="color: rgb(47, 134, 210);">$disk.Size</span><span style="color: rgb(123, 48, 208);"> /</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(123, 48, 208);">GB,</span><span style="color: rgb(23, 71, 129);"> 2</span><span style="color: rgb(0, 35, 57);">)</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskFirmware</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.FirmwareVersion</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskHealth</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.HealthStatus</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $isSSD</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.IsSSD</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskType</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$isSSD</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">"SSD"</span><span style="color: rgb(0, 35, 57);"> } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">"HDD"</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $partitionStyle</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $disk.PartitionStyle</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $perfKey</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(47, 134, 210);">$diskNumber</span><span style="color: rgb(164, 65, 133);">"</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $perfInstance</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $perfData.Keys</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> Where-Object</span><span style="color: rgb(0, 35, 57);"> { $_ </span><span style="color: rgb(123, 48, 208);">-like</span><span style="color: rgb(164, 65, 133);"> "*</span><span style="color: rgb(47, 134, 210);">$diskNumber</span><span style="color: rgb(164, 65, 133);">*"</span><span style="color: rgb(0, 35, 57);"> } </span><span style="color: rgb(123, 48, 208);">|</span><span style="color: rgb(26, 179, 148);"> Select-Object</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">First </span><span style="color: rgb(23, 71, 129);">1</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $readLatency</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.ReadLatency"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $writeLatency</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.WriteLatency"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $queueLength</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.QueueLength"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $readIOPS</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.ReadIOPS"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $writeIOPS</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.WriteIOPS"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $readMBps</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.ReadMBps"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $writeMBps</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$perfData</span><span style="color: rgb(0, 35, 57);">[</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(47, 134, 210);">$perfInstance</span><span style="color: rgb(164, 65, 133);">.WriteMBps"</span><span style="color: rgb(0, 35, 57);">] } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'N/A'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $smartTemp</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span><span style="color: rgb(0, 35, 57);">; </span><span style="color: rgb(47, 134, 210);">$smartWear</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        try</span><span style="color: rgb(0, 35, 57);"> {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">            $rel</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(26, 179, 148);"> Get-StorageReliabilityCounter</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">PhysicalDisk (</span><span style="color: rgb(26, 179, 148);">Get-PhysicalDisk</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> Where-Object</span><span style="color: rgb(0, 35, 57);"> DeviceId </span><span style="color: rgb(123, 48, 208);">-eq</span><span style="color: rgb(47, 134, 210);"> $diskNumber</span><span style="color: rgb(0, 35, 57);">) </span><span style="color: rgb(123, 48, 208);">-</span><span style="color: rgb(0, 35, 57);">ErrorAction SilentlyContinue</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">            if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$rel</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">                $smartTemp</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(47, 134, 210);">$rel.Temperature</span><span style="color: rgb(164, 65, 133);">)</span><span style="color: rgb(164, 65, 133);">°C"</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">                if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$rel.Wear</span><span style="color: rgb(123, 48, 208);"> -ne</span><span style="color: rgb(23, 71, 129);"> $null</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(47, 134, 210);">$smartWear</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(47, 134, 210);">$rel.Wear</span><span style="color: rgb(164, 65, 133);">)</span><span style="color: rgb(164, 65, 133);">%"</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">            }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        } </span><span style="color: rgb(123, 48, 208);">catch</span><span style="color: rgb(0, 35, 57);"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    } </span><span style="color: rgb(123, 48, 208);">else</span><span style="color: rgb(0, 35, 57);"> {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $diskNumber</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskModel</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskSerial</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskSizeGB</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskFirmware</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskHealth</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $diskType</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $partitionStyle</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $readLatency</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $writeLatency</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $queueLength</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $readIOPS</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $writeIOPS</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $readMBps</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $writeMBps</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $smartTemp</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $smartWear</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $healthSummary</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> switch</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(23, 71, 129);">$true</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        (</span><span style="color: rgb(47, 134, 210);">$diskHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Healthy'</span><span style="color: rgb(123, 48, 208);"> -and</span><span style="color: rgb(47, 134, 210);"> $volumeHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Healthy'</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="badge healthy"&gt;Healthy&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        (</span><span style="color: rgb(47, 134, 210);">$diskHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Warning'</span><span style="color: rgb(123, 48, 208);"> -or</span><span style="color: rgb(47, 134, 210);"> $volumeHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Warning'</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="badge warning"&gt;Warning&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        (</span><span style="color: rgb(47, 134, 210);">$diskHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Unhealthy'</span><span style="color: rgb(123, 48, 208);"> -or</span><span style="color: rgb(47, 134, 210);"> $volumeHealth</span><span style="color: rgb(123, 48, 208);"> -eq</span><span style="color: rgb(164, 65, 133);"> 'Unhealthy'</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span classl="badge failed"&gt;Failed&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        (</span><span style="color: rgb(47, 134, 210);">$operationalStatus</span><span style="color: rgb(123, 48, 208);"> -ne</span><span style="color: rgb(164, 65, 133);"> 'OK'</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="badge failed"&gt;Offline&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">        default</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="badge unknown"&gt;Unknown&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $perfGrade</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">    if</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$readLatency</span><span style="color: rgb(123, 48, 208);"> -ne</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span><span style="color: rgb(123, 48, 208);"> -and</span><span style="color: rgb(47, 134, 210);"> $writeLatency</span><span style="color: rgb(123, 48, 208);"> -ne</span><span style="color: rgb(164, 65, 133);"> 'N/A'</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $avgLat</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$readLatency</span><span style="color: rgb(123, 48, 208);"> +</span><span style="color: rgb(47, 134, 210);"> $writeLatency</span><span style="color: rgb(0, 35, 57);">) </span><span style="color: rgb(123, 48, 208);">/</span><span style="color: rgb(23, 71, 129);"> 2</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">        $perfGrade</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> switch</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(23, 71, 129);">$true</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">            (</span><span style="color: rgb(47, 134, 210);">$avgLat</span><span style="color: rgb(123, 48, 208);"> -lt</span><span style="color: rgb(23, 71, 129);"> 1</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="perf excellent"&gt;Excellent&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">            (</span><span style="color: rgb(47, 134, 210);">$avgLat</span><span style="color: rgb(123, 48, 208);"> -lt</span><span style="color: rgb(23, 71, 129);"> 5</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="perf good"&gt;Good&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">            (</span><span style="color: rgb(47, 134, 210);">$avgLat</span><span style="color: rgb(123, 48, 208);"> -lt</span><span style="color: rgb(23, 71, 129);"> 15</span><span style="color: rgb(0, 35, 57);">) { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="perf fair"&gt;Fair&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">            default</span><span style="color: rgb(0, 35, 57);"> { </span><span style="color: rgb(164, 65, 133);">'&lt;span class="perf poor"&gt;Poor&lt;/span&gt;'</span><span style="color: rgb(0, 35, 57);"> }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">        }</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $obj</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">PSCustomObject</span><span style="color: rgb(0, 35, 57);">]</span><span style="color: rgb(123, 48, 208);">@</span><span style="color: rgb(0, 35, 57);">{</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Drive'</span><span style="color: rgb(123, 48, 208);">           =</span><span style="color: rgb(47, 134, 210);"> $driveLetter</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'FS'</span><span style="color: rgb(123, 48, 208);">              =</span><span style="color: rgb(47, 134, 210);"> $fileSystem</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Cluster'</span><span style="color: rgb(123, 48, 208);">         =</span><span style="color: rgb(47, 134, 210);"> $clusterSizeKB</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Total'</span><span style="color: rgb(123, 48, 208);">           =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(47, 134, 210);">$totalSizeGB</span><span style="color: rgb(164, 65, 133);"> GB"</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Free'</span><span style="color: rgb(123, 48, 208);">            =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(47, 134, 210);">$freeSizeGB</span><span style="color: rgb(164, 65, 133);"> GB (</span><span style="color: rgb(47, 134, 210);">$freePct</span><span style="color: rgb(164, 65, 133);">%)"</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Style'</span><span style="color: rgb(123, 48, 208);">           =</span><span style="color: rgb(47, 134, 210);"> $partitionStyle</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Disk'</span><span style="color: rgb(123, 48, 208);">            =</span><span style="color: rgb(47, 134, 210);"> $diskNumber</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Model'</span><span style="color: rgb(123, 48, 208);">           =</span><span style="color: rgb(47, 134, 210);"> $diskModel</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Serial'</span><span style="color: rgb(123, 48, 208);">          =</span><span style="color: rgb(47, 134, 210);"> $diskSerial</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Type'</span><span style="color: rgb(123, 48, 208);">            =</span><span style="color: rgb(47, 134, 210);"> $diskType</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Health'</span><span style="color: rgb(123, 48, 208);">          =</span><span style="color: rgb(47, 134, 210);"> $healthSummary</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Temp'</span><span style="color: rgb(123, 48, 208);">            =</span><span style="color: rgb(47, 134, 210);"> $smartTemp</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Wear'</span><span style="color: rgb(123, 48, 208);">            =</span><span style="color: rgb(47, 134, 210);"> $smartWear</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'R-IOPS'</span><span style="color: rgb(123, 48, 208);">          =</span><span style="color: rgb(47, 134, 210);"> $readIOPS</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'W-IOPS'</span><span style="color: rgb(123, 48, 208);">          =</span><span style="color: rgb(47, 134, 210);"> $writeIOPS</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'R-MB/s'</span><span style="color: rgb(123, 48, 208);">          =</span><span style="color: rgb(47, 134, 210);"> $readMBps</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'W-MB/s'</span><span style="color: rgb(123, 48, 208);">          =</span><span style="color: rgb(47, 134, 210);"> $writeMBps</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'R-Lat'</span><span style="color: rgb(123, 48, 208);">           =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(47, 134, 210);">$readLatency</span><span style="color: rgb(164, 65, 133);"> ms"</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'W-Lat'</span><span style="color: rgb(123, 48, 208);">           =</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(47, 134, 210);">$writeLatency</span><span style="color: rgb(164, 65, 133);"> ms"</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Queue'</span><span style="color: rgb(123, 48, 208);">           =</span><span style="color: rgb(47, 134, 210);"> $queueLength</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        'Perf'</span><span style="color: rgb(123, 48, 208);">            =</span><span style="color: rgb(47, 134, 210);"> $perfGrade</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $data</span><span style="color: rgb(123, 48, 208);"> +=</span><span style="color: rgb(47, 134, 210);"> $obj</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># === Responsive HTML ===</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$header</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> @"</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;!DOCTYPE html&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;html lang="en"&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;head&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;meta charset="UTF-8"&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;title&gt;Drive Report&lt;/title&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;style&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        :root { --primary: #1565c0; --success: #2e7d32; --warning: #ef6c00; --danger: #c62828; --gray: #555; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        * { box-sizing: border-box; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: linear-gradient(135deg, #e3f2fd, #bbdefb); margin: 0; padding: 16px; color: #333; font-size: clamp(12px, 2.5vw, 16px); }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .container { max-width: 100%; margin: auto; background: white; padding: clamp(16px, 3vw, 32px); border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        h1 { text-align: center; color: var(--primary); margin: 0 0 8px; font-size: clamp(1.5rem, 5vw, 2.2rem); }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .subtitle { text-align: center; color: #555; font-style: italic; font-size: clamp(0.9rem, 2.5vw, 1rem); margin: 0 0 16px; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .meta { font-size: clamp(0.8rem, 2vw, 0.95rem); color: #666; text-align: center; margin-bottom: 16px; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .note { background: #e3f2fd; padding: 12px; border-radius: 8px; font-size: clamp(0.75rem, 2vw, 0.9rem); color: var(--primary); margin: 16px 0; text-align: center; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .table-container { overflow-x: auto; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin: 20px 0; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        table { width: 100%; min-width: 800px; border-collapse: collapse; font-size: clamp(0.7rem, 1.8vw, 0.9rem); }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        th { background: var(--primary); color: white; padding: clamp(8px, 1.5vw, 12px); text-align: left; white-space: nowrap; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        td { padding: clamp(6px, 1.2vw, 10px); border-bottom: 1px solid #eee; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        tr:nth-child(even) { background-color: #f9fbfd; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        tr:hover { background-color: #e1f5fe; transition: 0.2s; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .badge, .perf { padding: 4px 8px; border-radius: 12px; font-size: 0.75em; font-weight: bold; display: inline-block; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .healthy { background:#e8f5e9; color:var(--success); }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .warning { background:#fff3e0; color:var(--warning); }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .failed { background:#ffebee; color:var(--danger); }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .unknown { background:#eee; color:var(--gray); }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .excellent { background:#e8f5e9; color:#1b5e20; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .good { background:#e6f7ff; color:#00695c; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .fair { background:#fff8e1; color:#ff8f00; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .poor { background:#ffebee; color:#b71c1c; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .footer { text-align: center; margin-top: 32px; color: #777; font-size: clamp(0.7rem, 2vw, 0.85rem); }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        .collapse-btn { display: none; background: var(--primary); color: white; border: none; padding: 10px; width: 100%; font-size: 1rem; cursor: pointer; border-radius: 8px; margin-bottom: 8px; }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        @media (max-width: 768px) { .collapse-btn { display: block; } .table-container { display: none; } .table-container.show { display: block; } }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;/style&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;/head&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;body&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;div class="container"&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;h1&gt;Drive Report&lt;/h1&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;p class="subtitle"&gt;Performance • Health • Configuration&lt;/p&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;p class="meta"&gt;&lt;strong&gt;Host:&lt;/strong&gt; </span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(47, 134, 210);">$env:COMPUTERNAME</span><span style="color: rgb(164, 65, 133);">)</span><span style="color: rgb(164, 65, 133);"> | &lt;strong&gt;User:&lt;/strong&gt; </span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(47, 134, 210);">$env:USERNAME</span><span style="color: rgb(164, 65, 133);">)</span><span style="color: rgb(164, 65, 133);">&lt;/p&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;div class="note"&gt;&lt;strong&gt;Tip:&lt;/strong&gt; On mobile, tap below to view full table&lt;/div&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;button class="collapse-btn" onclick="document.querySelector('.table-container').classList.toggle('show')"&gt;Tap to Show/Hide Table&lt;/button&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">"@</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># Generate HTML Table</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$htmlTable</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $data</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> Sort-Object</span><span style="color: rgb(0, 35, 57);"> Drive </span><span style="color: rgb(123, 48, 208);">|</span><span style="color: rgb(26, 179, 148);"> ConvertTo-Html</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">Fragment </span><span style="color: rgb(123, 48, 208);">-</span><span style="color: rgb(0, 35, 57);">Property </span><span style="color: rgb(123, 48, 208);">*</span><span style="color: rgb(123, 48, 208);"> -As</span><span style="color: rgb(0, 35, 57);"> Table</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$htmlTable</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $htmlTable</span><span style="color: rgb(123, 48, 208);"> -replace</span><span style="color: rgb(164, 65, 133);"> '&lt;table&gt;'</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(164, 65, 133);"> '&lt;div class="table-container"&gt;&lt;table&gt;'</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$htmlTable</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $htmlTable</span><span style="color: rgb(123, 48, 208);"> -replace</span><span style="color: rgb(164, 65, 133);"> '&lt;/table&gt;'</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(164, 65, 133);"> '&lt;/table&gt;&lt;/div&gt;'</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># Replace badges</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$replacements</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(123, 48, 208);"> @</span><span style="color: rgb(0, 35, 57);">{</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Healthy'</span><span style="color: rgb(123, 48, 208);">   =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="badge healthy"&gt;Healthy&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Warning'</span><span style="color: rgb(123, 48, 208);">   =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="badge warning"&gt;Warning&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Failed'</span><span style="color: rgb(123, 48, 208);">    =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="badge failed"&gt;Failed&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Offline'</span><span style="color: rgb(123, 48, 208);">   =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="badge failed"&gt;Offline&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Unknown'</span><span style="color: rgb(123, 48, 208);">   =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="badge unknown"&gt;Unknown&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Excellent'</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="perf excellent"&gt;Excellent&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Good'</span><span style="color: rgb(123, 48, 208);">      =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="perf good"&gt;Good&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Fair'</span><span style="color: rgb(123, 48, 208);">      =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="perf fair"&gt;Fair&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    'Poor'</span><span style="color: rgb(123, 48, 208);">      =</span><span style="color: rgb(164, 65, 133);"> '&lt;span class="perf poor"&gt;Poor&lt;/span&gt;'</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">}</span></span>
<span class="line"><span style="color: rgb(123, 48, 208);">foreach</span><span style="color: rgb(0, 35, 57);"> (</span><span style="color: rgb(47, 134, 210);">$key</span><span style="color: rgb(123, 48, 208);"> in</span><span style="color: rgb(47, 134, 210);"> $replacements.Keys</span><span style="color: rgb(0, 35, 57);">) {</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">    $htmlTable</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $htmlTable</span><span style="color: rgb(123, 48, 208);"> -replace</span><span style="color: rgb(0, 35, 57);"> [</span><span style="color: rgb(9, 145, 182);">regex</span><span style="color: rgb(0, 35, 57);">]::Escape(</span><span style="color: rgb(164, 65, 133);">"&lt;td&gt;</span><span style="color: rgb(47, 134, 210);">$key</span><span style="color: rgb(164, 65, 133);">&lt;/td&gt;"</span><span style="color: rgb(0, 35, 57);">)</span><span style="color: rgb(123, 48, 208);">,</span><span style="color: rgb(164, 65, 133);"> "&lt;td&gt;</span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(47, 134, 210);">$replacements</span><span style="color: rgb(164, 65, 133);">[</span><span style="color: rgb(47, 134, 210);">$key</span><span style="color: rgb(164, 65, 133);">])</span><span style="color: rgb(164, 65, 133);">&lt;/td&gt;"</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$footer</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> @"</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;div class="footer"&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        Generated by &lt;strong&gt;clustersize_check.ps1&lt;/strong&gt; | </span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">(</span><span style="color: rgb(26, 179, 148);">Get-Date</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(164, 65, 133);">Format </span><span style="color: rgb(164, 65, 133);">'yyyy-MM-dd HH:mm:ss'</span><span style="color: rgb(164, 65, 133);">)</span><span style="color: rgb(164, 65, 133);"> | </span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        &lt;span style="color:var(--primary);"&gt;Responsive on all devices&lt;/span&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    &lt;/div&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;/div&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;script&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    if (window.innerWidth &lt;= 768) {</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">        document.querySelector('.table-container').classList.remove('show');</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">    }</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;/script&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;/body&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">&lt;/html&gt;</span></span>
<span class="line"><span style="color: rgb(164, 65, 133);">"@</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># === Export HTML ===</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$html</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(47, 134, 210);"> $header</span><span style="color: rgb(123, 48, 208);"> +</span><span style="color: rgb(47, 134, 210);"> $htmlTable</span><span style="color: rgb(123, 48, 208);"> +</span><span style="color: rgb(47, 134, 210);"> $footer</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$htmlFile</span><span style="color: rgb(123, 48, 208);"> =</span><span style="color: rgb(164, 65, 133);"> "$PSScriptRoot\drive_info.html"</span></span>
<span class="line"><span style="color: rgb(47, 134, 210);">$html</span><span style="color: rgb(123, 48, 208);"> |</span><span style="color: rgb(26, 179, 148);"> Out-File</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">FilePath </span><span style="color: rgb(47, 134, 210);">$htmlFile</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">Encoding UTF8</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(53, 123, 66); font-style: italic;"># === Auto-Open in Default Browser ===</span></span>
<span class="line"><span style="color: rgb(26, 179, 148);">Write-Host</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(23, 71, 129);">`n</span><span style="color: rgb(164, 65, 133);">Report generated: "</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">NoNewline</span></span>
<span class="line"><span style="color: rgb(26, 179, 148);">Write-Host</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(47, 134, 210);">$htmlFile</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">ForegroundColor Green</span></span>
<span class="line"><span style="color: rgb(26, 179, 148);">Write-Host</span><span style="color: rgb(164, 65, 133);"> "Opening in default browser..."</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">ForegroundColor Cyan</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(123, 48, 208);">try</span><span style="color: rgb(0, 35, 57);"> {</span></span>
<span class="line"><span style="color: rgb(26, 179, 148);">    Start-Process</span><span style="color: rgb(47, 134, 210);"> $htmlFile</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">} </span><span style="color: rgb(123, 48, 208);">catch</span><span style="color: rgb(0, 35, 57);"> {</span></span>
<span class="line"><span style="color: rgb(26, 179, 148);">    Write-Warning</span><span style="color: rgb(164, 65, 133);"> "Could not open browser: </span><span style="color: rgb(123, 48, 208);">$</span><span style="color: rgb(164, 65, 133);">($_</span><span style="color: rgb(47, 134, 210);">.Exception.Message</span><span style="color: rgb(164, 65, 133);">)</span><span style="color: rgb(164, 65, 133);">"</span></span>
<span class="line"><span style="color: rgb(26, 179, 148);">    Write-Host</span><span style="color: rgb(164, 65, 133);"> "Manually open: </span><span style="color: rgb(47, 134, 210);">$htmlFile</span><span style="color: rgb(164, 65, 133);">"</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">ForegroundColor Yellow</span></span>
<span class="line"><span style="color: rgb(0, 35, 57);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: rgb(26, 179, 148);">Write-Host</span><span style="color: rgb(164, 65, 133);"> "</span><span style="color: rgb(23, 71, 129);">`n</span><span style="color: rgb(164, 65, 133);">Done! Report is open."</span><span style="color: rgb(123, 48, 208);"> -</span><span style="color: rgb(0, 35, 57);">ForegroundColor Green</span></span></code></pre></div>
